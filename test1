# Visualize top 20 most influential features
import seaborn as sns

coef_df = pd.Series(ridge.coef_, index=X_train.columns).sort_values(key=np.abs, ascending=False).head(20)
plt.figure(figsize=(10, 6))
sns.barplot(x=coef_df.values, y=coef_df.index)
plt.title("Top 20 Influential Features (Ridge Coefficients)")
plt.xlabel("Coefficient Value")
plt.tight_layout()
plt.show()

# Heatmap of top features most correlated with SalePrice
train_corr = train.copy()
train_corr["SalePrice"] = y_train
plt.figure(figsize=(12, 10))
top_corr = train_corr.corr()["SalePrice"].abs().sort_values(ascending=False).head(20).index
sns.heatmap(train_corr[top_corr].corr(), annot=True, fmt=".2f", cmap="coolwarm")
plt.title("Top 20 Feature Correlations with SalePrice")
plt.tight_layout()
plt.show()

# Residual plot to evaluate model fit
y_train_pred = ridge.predict(X_train_scaled)
residuals = y_train - y_train_pred
plt.figure(figsize=(8, 5))
plt.scatter(y_train_pred, residuals, alpha=0.5)
plt.axhline(0, color='red', linestyle='--')
plt.title("Residuals vs Predicted Log SalePrice")
plt.xlabel("Predicted Log SalePrice")
plt.ylabel("Residuals")
plt.tight_layout()
plt.show()
